function renumberEditorRows(){TEMPLATE_EDITOR.querySelectorAll("editor-row.attr").forEach((e,t)=>{e.index=t+1})}function createSpacer(){const e=document.createElement("div");return e.classList.add("spacer"),e.ondragover=function(e){return e.preventDefault(),!1},e.ondrop=function(e){e.stopPropagation();e=dragSource.nextSibling;return this.parentElement.insertBefore(dragSource,this.nextSibling),this.parentElement.insertBefore(e,dragSource.nextSibling),dragSource.clearDragClasses(),renumberEditorRows(),!1},e}function appendBlankRow(){const e=document.createElement("editor-row");return e.index=TEMPLATE_EDITOR.querySelectorAll("editor-row.attr").length+1,e.classList.add("attr"),e.draggable=!0,TEMPLATE_EDITOR.appendChild(e),TEMPLATE_EDITOR.appendChild(createSpacer()),e}function updateTaxonomyFields({taxonomy_id:e="",scientific_name:t="",common_name:n=""}){const r=document.querySelector("div#taxonomy");r.querySelector("#taxonomy-id").value=e,r.querySelector("#scientific-name").value=t,r.querySelector("#common-name").value=n}function fillFromTemplate(e){document.querySelector("#template-name-field").disabled=!0;let t=new HiddenField("template_name");t.setValue(e.name),document.querySelector("#name-field").appendChild(t.input);let n;if(e.attributes.forEach(e=>{e.ena_units=[e.ena_units],(n=appendBlankRow()).setFromAttribute(e)}),e.ena_checklist){const r=document.querySelector("div#ena-import"),a=(r.querySelector("#fetch-ena-button").disabled=!0,r.querySelector("#ena-checklist"));a.disabled=!0,a.value=e.ena_checklist,(t=new HiddenField("ena_checklist+0+ena_checklist")).setValue(e.ena_checklist),r.appendChild(t.input)}updateTaxonomyFields(e.taxonomy)}TEMPLATE_NAME&&fetch("/templates/json?name="+TEMPLATE_NAME).then(e=>e.json()).then(e=>{fillFromTemplate(e)});