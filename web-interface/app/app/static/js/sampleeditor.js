async function fetchTemplate(){const e=await fetch("/templates/json/"+TEMPLATE_ID);return e.json()}function createAttributeField(e,t=!1){let a;switch(a=document.createElement("input"),e.type_){case"text":(a=document.createElement("input")).type="text",e.pattern&&(a.pattern=e.pattern),e.default&&(a.value=e.default);break;case"select":a=createSelectMenu(parseOptions(e.options)),e.default&&(a.value=e.default);break;case"date":(a=document.createElement("input")).type="date",e.default&&(a.value=e.default);break;case"template":(a=document.createElement("input")).type="text",a.placeholder=e.template,a.setAttribute("template-string",e.template)}return t&&a.addEventListener("change",function(){changeAll(this)},!1),a.classList.add(e.type_),a}function changeAll(t){t.parentElement.parentElement.querySelectorAll(".sample.attr").forEach(e=>{e.querySelector(".attr.field").value=t.value})}function parseTemplateString(e){let t=[],a=!0;return[...e].forEach(e=>{a="["==e?(t.push({type:"var",value:""}),!1):"]"==e||(a&&t.push({type:"const",value:""}),t[t.length-1].value+=e,!1)}),t}function updateTemplateFields(e){let t;Array.from(document.querySelectorAll(".field.attr.template")).forEach(e=>{t=parseTemplateString(e.getAttribute("template-string")),console.log(t)})}function createNewRow(e){const t=document.createElement("tr"),a=(t.classList.add("row",e.general_name),document.createElement("th")),l=(a.innerHTML=e.label,t.appendChild(a),document.createElement("td")),n=(l.appendChild(createAttributeField(e,isEditAll=!0)),t.appendChild(l),document.createElement("td"));return n.innerHTML=e.description,t.appendChild(n),t}async function addNewSample(){const e=await fetchTemplate(),t=document.querySelector("#sample-editor").tBodies[0];let a,l,n;e.attributes.forEach(e=>{a=t.querySelector(".row."+e.general_name),(n=createAttributeField(e)).classList.add("field","attr",e.general_name),(l=a.insertCell(a.cells.length-1)).classList.add("attr","sample",e.general_name),l.appendChild(n)})}async function initSampleEditor(){const e=await fetchTemplate(),t=document.querySelector("#sample-editor").tBodies[0];let a;e.attributes.forEach(e=>{a=createNewRow(e),t.appendChild(a)})}initSampleEditor();