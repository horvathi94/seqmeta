const FIELDTYPES=["text","select","date","template"];class Cell{cell;constructor(e){this.cell=document.createElement("div"),this.cell.classList.add("cell",e),this.getContent().forEach(e=>{this.cell.appendChild(e)})}getContent(){return[]}}class RemoveCell extends Cell{constuctor(e){super(e)}getContent(){const e=document.createElement("input");return e.setAttribute("type","button"),e.classList.add("rmbutton"),e.value="X",e.onclick=function(){this.parentElement.parentElement.remove()},e}}class TemplateAttr{index;status;row;constructor(e,t){this.index=e,this.status=t,this.row=document.createElement("div")}appendCell(e){}}const TEMPLATE_EDITOR=document.querySelector("#template-editor");function addNewAttribute(e=0){var t=TemplateAttr(1,"new");console.log(t)}function createNewField(e,t,l,a=[]){console.log("Optiosn: ",a);var r=["field","attr",l];return createInputField(t,l=`attr+${e}+`+l,a,r)}function createParameterField(e,t){let l;switch(t){case"text":l=createPatternField(e);break;case"select":l=createOptionsField(e);break;case"template":(l=createNewField(e,"text","template")).placeholder="Template for creating the variable.";break;default:(l=createNewField(e,"text","junk")).placeholder="N/A",l.disabled=!0}return l.classList.add("param"),l}function createDefaultField(e,t,l=[],a=""){let r;return"text"==t&&(r=createNewField(e,"text","default"),""!=a&&(r.pattern=a)),"date"==t&&(r=createNewField(e,"date","default")),"select"==t&&(r=createNewField(e,"select","default",l)),"template"==t&&((r=createNewField(e,"text","default")).placeholder="N/A",r.value="",r.disabled=!0),r}const REQUIREMENTS=["exclude","optional","recommended","mandatory"];function createRequirementField(e,t){const l=createNewField(e,"select",t+"_requirement",options=REQUIREMENTS);return l.addEventListener("change",function(){changedRequirement(this)},!1),l}function updateDefaultField(e,t=null){null===t&&(t=e.querySelector(".cell.type>.attr.field.type_").value);const l=e.querySelector(".cell.default"),a=l.querySelector(".field.attr.default");var r=a.name.split("+")[1];let n=[],c="";"text"==t&&(c=e.querySelector(".parameters.cell>.pattern").value);r=createDefaultField(r,t,n=n="select"==t?e.querySelector(".parameters.cell>.options").value.split(","):n,c=c);l.replaceChild(r,a)}function changedAttributeType(e){const t=e.querySelector(".cell.parameters"),l=t.querySelector(".field.attr.param");var a=e.querySelector(".cell.type>.attr.field.type_").value,r=l.name.split("+")[1];t.replaceChild(createParameterField(r,a),l),updateDefaultField(e,a)}function changedRequirement(e){const t=e.parentElement.parentElement.querySelector(".cell.rm>.rmbutton");"mandatory"==e.value||"recommended"==e.value?t.disabled=!0:t.disabled=!1}function appendRepoField(e,t,l){return(cell=appendNewCell(e,t)).appendChild(createNewField(l,"text",t+"_name")),cell.appendChild(createRequirementField(l,t)),cell}function createNewRow(e){const t=document.createElement("div");t.classList.add("attr","row");let l=appendNewCell(t,"rm");return l.appendChild(createRemoveButton()),(l=appendNewCell(t,"name")).appendChild(createGeneralNameField(e)),(l=appendNewCell(t,"label")).appendChild(createNewField(e,"text","label")),(l=appendNewCell(t,"type")).appendChild(createTypeField(e)),appendRepoField(t,"ena",e),appendRepoField(t,"gisaid",e),(l=appendNewCell(t,"parameters")).appendChild(createParameterField(e,"text")),(l=appendNewCell(t,"default")).appendChild(createDefaultField(e,"text")),(l=appendNewCell(t,"description")).appendChild(createNewField(e,"textarea","description")),t}function createRow(e=0){TemplateAttr()}async function fetchTemplate(e){const t=await fetch("/templates/json/"+e);return t.json()}async function loadTemplate(){var e=parseInt(document.querySelector("#template-id-field").value);e&&(e=await fetchTemplate(e),console.log(e))}